# 離線 MQTT 客戶端 - 使用說明

## 概述
這是一個獨立、可離線運作的 MQTT 客戶端，設計用於在瀏覽器中執行，無需後端伺服器。它透過 WebSocket 安全地連線至您的 MQTT Broker。

## 如何使用

### 1. 開啟客戶端
使用檔案總管，導航至：
`/Users/mosica/git/TRA/Utility/MQTT_Offline_Client/`

雙擊 **`index.html`** 在您的預設瀏覽器中開啟。

### 2. 驗證憑證 (關鍵步驟)
由於您的 Broker (`wss://s10001.gate.railway.gov.tw:9443`) 使用自簽署憑證與 mTLS：
1.  請確保您的 **客戶端憑證 (Client Certificate)** 已安裝在您的個人使用者憑證儲存區 (Windows/Mac) 或瀏覽器憑證管理員中。
2.  開啟一個新的瀏覽器分頁並訪問：`https://s10001.gate.railway.gov.tw:9443`
3.  如果您看到安全警告（「不安全」/「您的連線不是私密的」），請確認該憑證正確，然後選擇 **「繼續前往... (不安全)」** 以在此工作階段中明確信任它。
4.  如果出現提示，請選擇您的 **客戶端憑證**。
5.  頁面載入後（即使是 404 或白畫面），關閉該分頁並返回 MQTT 客戶端。

### 3. 連線
1.  **連線 (Connection)** 面板已預先填入您的 Broker 資訊。
2.  點擊 **連線 Connect**。
3.  瀏覽器可能會再次提示您選擇客戶端憑證。請選擇正確的憑證。
4.  狀態指示燈應變為 **綠色 (Connected)**。

### 4. 訂閱與查看訊息
1.  在 **訂閱 (Subscription)** 面板中，預設主題為 `#` (監聽所有內容)。
2.  點擊 **訂閱 Subscribe** (如果連線時已有輸入 Topic，會自動訂閱)。
3.  訊息將即時顯示在下方的 **訊息 (Messages)** 面板中。

## 疑難排解

-   **狀態一直停留在 "Connecting..."**：
    -   檢查 WebSocket 連接埠 (9443) 是否可存取。
    -   確保您已先用瀏覽器直接訪問 URL 並接受自簽署憑證。
-   **狀態顯示 "Error"**：
    -   開啟開發者工具 (F12) -> Console 查看詳細錯誤訊息。
    -   常見原因：憑證驗證失敗或已被撤銷。
